<!doctype html>
<html lang="en">
	<head>
		<title>Edge-based tree data structures - ralismark</title>

<!--[if lt IE 9]>
	<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->

<meta charset="utf-8">
<meta http-equiv='X-UA-Compatible' content='IE=edge'>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="canonical" href="/posts/edge-trees">
<meta name="description" content="A novel data structure to solve widest path problems">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/logo-32.png">

<link type="application/atom+xml" rel="alternate" href="/feed.xml" title="ralismark" />

<link rel="preconnect" href="https://fonts.gstatic.com">
<link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap" rel="stylesheet">

<link rel="stylesheet" href="/assets/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">

<!-- experiment: indieweb -->
<link rel="webmention" href="https://webmention.io/www.ralismark.xyz/webmention" />
<link rel="pingback" href="https://webmention.io/www.ralismark.xyz/xmlrpc" />

	</head>
	<body>
		<header id="site-nav" class="full-width text-inverted">
	<nav class="content-width flex-distribute">
		<a id="navbar-root" href="/">ralismark</a>

		

		<ul id="navbar-pages" class="list-inline my-0">
			
			
			
			
			
			
			
			
			
			
			<li class="navbar-page">
				<a class="navbar-link" href="/posts">
					Blog
				</a>
			</li>
			
			
			
			
			
			
			
			
			
			
		</ul>
	</nav>
</header>


		<main class="content-width my-2 h-entry">
			<nav class="post-nav flex-distribute my-1">
	
		<a class="prev" href="/posts/speed-of-light">&laquo; A simple "derivation" of the speed of light</a>
	

	
		<a class="next" href="/posts/nearer-optimal-solution">Proving Algorithms using Nearer Optimal Solution &raquo;</a>
	
</nav>


<header class="post-meta fenced-b mb-1 text-centre bleed">
	<h1 id="post-title" class="p-name">Edge-based tree data structures</h1>
	<p class="p-summary"><em>
		A novel data structure to solve widest path problems
	</em></p>
	<ul class="li-flat">
		<li>
		<time datetime="2019-05-28T00:00:00-05:00" class="dt-published">
			<a class="u-url" href="/posts/edge-trees">
			28 May 2019
			</a>
		</time>
		</li>

		<li>
			
			<abbr title="1533 total words">8 mins to read</abbr>
		</li>

		
		
		<li id="post-tags">
			<span id="post-tag-label">Tags:</span>
			
				<a class="p-category badge" href="/tags#informatics">informatics</a>
			
		</li>
		
	</p>
</header>

<article class="post-content e-content bounded">
	<blockquote>
  <p>This post has been rewritten in May 2020.</p>
</blockquote>

<p>A few days ago, I was thinking about the tree generated from recursively performing centroid decomposition as well as Cartesian trees, and noticed a surprising similarly. I continued exploring this idea, and rediscovered a data structure that provides new insight into graph problems based on the max/min edge weight along paths (widest path/bottleneck edge problems).</p>

<!--more-->

<h2 id="preface-existing-terminology"><a href="#preface-existing-terminology">Preface: Existing Terminology</a></h2>

<p>It turns out a portion of what I’ve discussed here already exists, and can be found by searching “Cartesian tree of edges” – <a href="https://erikdemaine.org/papers/Cartesian_ICALP2009/paper.pdf">this paper</a> for example.</p>

<p>However, my terminology I use in this post differs from what’s used in existing literature. In particular:</p>

<ul>
  <li>What I call a <em>Cartesian Tree of a Tree</em> is not described in literature</li>
  <li>What I call a <em>Kruskal Tree</em> is called a <em>Cartesian Tree of a Tree</em> in the above paper.</li>
</ul>

<p>I apologise for this confusion, but it’s somewhat unavoidable, as you’ll see later on.</p>

<h2 id="centroid-trees"><a href="#centroid-trees">Centroid Trees</a></h2>

<p>I’ll lay out the path to get to the Kruskal Tree. First, a few definitions, if you’re not familiar with them:</p>

<ul>
  <li>A <strong>centroid</strong> of a tree is a vertex that, when removed, leaves components which are at most half the size of the original tree.</li>
  <li>A <strong>centroid tree</strong> (also known as the <strong>centroid decomposition</strong> of a tree) is generated by extracting the centroid of a tree, then making the centroid decomposition of the remaining components its children.</li>
</ul>

<svg xmlns="http://www.w3.org/2000/svg" width="404pt" height="125pt" viewBox="0.00 0.00 404.00 125.00">
  <g class="graph" transform="scale(1 1) rotate(0) translate(4 121)">
    <title>%3</title>
    <g class="node">
      <title>d</title>
      <ellipse fill="none" stroke="black" cx="18" cy="-99" rx="18" ry="18" />
      <text text-anchor="middle" x="18" y="-95.3" font-family="Times,serif" font-size="14.00">d</text>
    </g>
    <g class="node">
      <title>b</title>
      <ellipse fill="none" stroke="black" cx="90" cy="-72" rx="18" ry="18" />
      <text text-anchor="middle" x="90" y="-68.3" font-family="Times,serif" font-size="14.00">b</text>
    </g>
    <g class="edge">
      <title>d--b</title>
      <path fill="none" stroke="black" d="M35.24,-92.74C46.54,-88.38 61.56,-82.58 72.85,-78.23" />
    </g>
    <g class="node">
      <title>e</title>
      <ellipse fill="none" stroke="black" cx="162" cy="-72" rx="18" ry="18" />
      <text text-anchor="middle" x="162" y="-68.3" font-family="Times,serif" font-size="14.00">e</text>
    </g>
    <g class="edge">
      <title>b--e</title>
      <path fill="none" stroke="black" d="M108.3,-72C119.15,-72 133.08,-72 143.9,-72" />
    </g>
    <g class="node">
      <title>c</title>
      <ellipse fill="none" stroke="black" cx="306" cy="-45" rx="18" ry="18" />
      <text text-anchor="middle" x="306" y="-41.3" font-family="Times,serif" font-size="14.00">c</text>
    </g>
    <g class="node">
      <title>f</title>
      <ellipse fill="none" stroke="black" cx="378" cy="-72" rx="18" ry="18" />
      <text text-anchor="middle" x="378" y="-68.3" font-family="Times,serif" font-size="14.00">f</text>
    </g>
    <g class="edge">
      <title>c--f</title>
      <path fill="none" stroke="black" d="M323.24,-51.26C334.54,-55.62 349.56,-61.42 360.85,-65.77" />
    </g>
    <g class="node">
      <title>h</title>
      <ellipse fill="none" stroke="black" cx="378" cy="-18" rx="18" ry="18" />
      <text text-anchor="middle" x="378" y="-14.3" font-family="Times,serif" font-size="14.00">h</text>
    </g>
    <g class="edge">
      <title>c--h</title>
      <path fill="none" stroke="black" d="M323.24,-38.74C334.54,-34.38 349.56,-28.58 360.85,-24.23" />
    </g>
    <g class="node">
      <title>g</title>
      <ellipse fill="none" stroke="black" cx="234" cy="-99" rx="18" ry="18" />
      <text text-anchor="middle" x="234" y="-95.3" font-family="Times,serif" font-size="14.00">g</text>
    </g>
    <g class="edge">
      <title>e--g</title>
      <path fill="none" stroke="black" d="M179.24,-78.26C190.54,-82.62 205.56,-88.42 216.85,-92.77" />
    </g>
    <g class="node">
      <title>a</title>
      <ellipse fill="none" stroke="black" cx="234" cy="-45" rx="18" ry="18" />
      <text text-anchor="middle" x="234" y="-41.3" font-family="Times,serif" font-size="14.00">a</text>
    </g>
    <g class="edge">
      <title>e--a</title>
      <path fill="none" stroke="black" d="M179.24,-65.74C190.54,-61.38 205.56,-55.58 216.85,-51.23" />
    </g>
    <g class="edge">
      <title>a--c</title>
      <path fill="none" stroke="black" d="M252.3,-45C263.15,-45 277.08,-45 287.9,-45" />
    </g>
    <g class="node">
      <title>i</title>
      <ellipse fill="none" stroke="black" cx="18" cy="-45" rx="18" ry="18" />
      <text text-anchor="middle" x="18" y="-41.3" font-family="Times,serif" font-size="14.00">i</text>
    </g>
    <g class="edge">
      <title>i--b</title>
      <path fill="none" stroke="black" d="M35.24,-51.26C46.54,-55.62 61.56,-61.42 72.85,-65.77" />
    </g>
  </g>
</svg>
<p><em>Figure 1: A random tree</em></p>

<svg xmlns="http://www.w3.org/2000/svg" width="260pt" height="188pt" viewBox="0.00 0.00 260.00 188.00">
  <g class="graph" transform="scale(1 1) rotate(0) translate(4 184)">
    <title>%3</title>
    <g class="node">
      <title>e</title>
      <ellipse fill="none" stroke="black" cx="126" cy="-162" rx="18" ry="18" />
      <text text-anchor="middle" x="126" y="-158.3" font-family="Times,serif" font-size="14.00">e</text>
    </g>
    <g class="node">
      <title>b</title>
      <ellipse fill="none" stroke="black" cx="72" cy="-90" rx="18" ry="18" />
      <text text-anchor="middle" x="72" y="-86.3" font-family="Times,serif" font-size="14.00">b</text>
    </g>
    <g class="edge">
      <title>e-&gt;b</title>
      <path fill="none" stroke="black" d="M115.33,-147.17C107.79,-137.39 97.52,-124.08 88.87,-112.87" />
      <polygon fill="black" stroke="black" points="91.53,-110.58 82.65,-104.8 85.98,-114.86 91.53,-110.58" />
    </g>
    <g class="node">
      <title>g</title>
      <ellipse fill="none" stroke="black" cx="126" cy="-90" rx="18" ry="18" />
      <text text-anchor="middle" x="126" y="-86.3" font-family="Times,serif" font-size="14.00">g</text>
    </g>
    <g class="edge">
      <title>e-&gt;g</title>
      <path fill="none" stroke="black" d="M126,-143.7C126,-135.98 126,-126.71 126,-118.11" />
      <polygon fill="black" stroke="black" points="129.5,-118.1 126,-108.1 122.5,-118.1 129.5,-118.1" />
    </g>
    <g class="node">
      <title>c</title>
      <ellipse fill="none" stroke="black" cx="180" cy="-90" rx="18" ry="18" />
      <text text-anchor="middle" x="180" y="-86.3" font-family="Times,serif" font-size="14.00">c</text>
    </g>
    <g class="edge">
      <title>e-&gt;c</title>
      <path fill="none" stroke="black" d="M136.67,-147.17C144.21,-137.39 154.48,-124.08 163.13,-112.87" />
      <polygon fill="black" stroke="black" points="166.02,-114.86 169.35,-104.8 160.47,-110.58 166.02,-114.86" />
    </g>
    <g class="node">
      <title>d</title>
      <ellipse fill="none" stroke="black" cx="18" cy="-18" rx="18" ry="18" />
      <text text-anchor="middle" x="18" y="-14.3" font-family="Times,serif" font-size="14.00">d</text>
    </g>
    <g class="edge">
      <title>b-&gt;d</title>
      <path fill="none" stroke="black" d="M61.33,-75.17C53.79,-65.39 43.52,-52.08 34.87,-40.87" />
      <polygon fill="black" stroke="black" points="37.53,-38.58 28.65,-32.8 31.98,-42.86 37.53,-38.58" />
    </g>
    <g class="node">
      <title>i</title>
      <ellipse fill="none" stroke="black" cx="72" cy="-18" rx="18" ry="18" />
      <text text-anchor="middle" x="72" y="-14.3" font-family="Times,serif" font-size="14.00">i</text>
    </g>
    <g class="edge">
      <title>b-&gt;i</title>
      <path fill="none" stroke="black" d="M72,-71.7C72,-63.98 72,-54.71 72,-46.11" />
      <polygon fill="black" stroke="black" points="75.5,-46.1 72,-36.1 68.5,-46.1 75.5,-46.1" />
    </g>
    <g class="node">
      <title>a</title>
      <ellipse fill="none" stroke="black" cx="126" cy="-18" rx="18" ry="18" />
      <text text-anchor="middle" x="126" y="-14.3" font-family="Times,serif" font-size="14.00">a</text>
    </g>
    <g class="edge">
      <title>c-&gt;a</title>
      <path fill="none" stroke="black" d="M169.33,-75.17C161.79,-65.39 151.52,-52.08 142.87,-40.87" />
      <polygon fill="black" stroke="black" points="145.53,-38.58 136.65,-32.8 139.98,-42.86 145.53,-38.58" />
    </g>
    <g class="node">
      <title>f</title>
      <ellipse fill="none" stroke="black" cx="180" cy="-18" rx="18" ry="18" />
      <text text-anchor="middle" x="180" y="-14.3" font-family="Times,serif" font-size="14.00">f</text>
    </g>
    <g class="edge">
      <title>c-&gt;f</title>
      <path fill="none" stroke="black" d="M180,-71.7C180,-63.98 180,-54.71 180,-46.11" />
      <polygon fill="black" stroke="black" points="183.5,-46.1 180,-36.1 176.5,-46.1 183.5,-46.1" />
    </g>
    <g class="node">
      <title>h</title>
      <ellipse fill="none" stroke="black" cx="234" cy="-18" rx="18" ry="18" />
      <text text-anchor="middle" x="234" y="-14.3" font-family="Times,serif" font-size="14.00">h</text>
    </g>
    <g class="edge">
      <title>c-&gt;h</title>
      <path fill="none" stroke="black" d="M190.67,-75.17C198.21,-65.39 208.48,-52.08 217.13,-40.87" />
      <polygon fill="black" stroke="black" points="220.02,-42.86 223.35,-32.8 214.47,-38.58 220.02,-42.86" />
    </g>
  </g>
</svg>
<p><em>Figure 2: The centroid decomposition of the above tree</em></p>

<p>Centroid trees are similar to binary search trees in that</p>

<ol>
  <li>the height is small; and</li>
  <li>nodes in a subtree represent connected elements.</li>
</ol>

<p>These properties are useful for “binary searching” on a tree e.g. in the problems <a href="https://orac.amt.edu.au/cgi-bin/train/problem.pl?set=fario19&amp;problemid=1064">Nav (FARIO 2019)</a> and <a href="https://codeforces.com/problemset/problem/1192/B">Dynamic Diameter (CEOI 2019)</a>. In fact, the centroid tree and the binary search tree of a <a href="https://en.wikipedia.org/wiki/Path_graph">linear/path graph</a> are identical.</p>

<h2 id="cartesian-tree-of-a-tree"><a href="#cartesian-tree-of-a-tree">Cartesian Tree of a Tree</a></h2>

<p>By using the similarity between centroid trees and binary search trees, we can arrive at the Cartesian tree of a tree: Instead of extracting the centroid, we instead extract the node with the least value. Just like centroid trees, doing this conversion on a linear graph produces a normal Cartesian tree.</p>

<p>However, this data structure isn’t of much interest to us (we’re using just as a stepping stone towards Kruskal Trees). One possible use to convert queries of “what is the minimum node on the path from A to B” into <a href="https://en.wikipedia.org/wiki/Lowest_common_ancestor">Lowest Common Ancestor</a> queries. It’s likely that “what is the minimum node in a given connected subgraph” queries can also be supported using a similar method.</p>

<h2 id="kruskal-tree"><a href="#kruskal-tree">Kruskal Tree</a></h2>

<blockquote>
  <p>These were called <em>edge trees</em> in my original post, but I feel <em>Kruskal tree</em> is a better name given the similarities between the tree I describe and Kruskal’s algorithm.</p>
</blockquote>

<p>One annoying aspect of the above data structure is that the number of children of each node is practically unbounded, with the worst case being a <a href="https://en.wikipedia.org/wiki/Star_(graph_theory)">star graph</a>. One method of sidestepping this issue (and getting a few other benefits) is to instead build the data structure over the <em>edges</em> of the input, instead of the vertices:</p>

<ol>
  <li>Pick the edge with the largest weight and extract it as the root of a new tree</li>
  <li>Recursively transform the two remaining components and add them as children of the extracted edge.</li>
</ol>

<p>As an example, if we perform this procedure on this tree:</p>

<svg xmlns="http://www.w3.org/2000/svg" width="364pt" height="132pt" viewBox="0.00 0.00 364.00 132.00">
  <g class="graph" transform="scale(1 1) rotate(0) translate(4 128)">
    <title>%3</title>
    <g class="node">
      <title>h</title>
      <ellipse fill="none" stroke="black" cx="98" cy="-29" rx="18" ry="18" />
      <text text-anchor="middle" x="98" y="-25.3" font-family="Times,serif" font-size="14.00">h</text>
    </g>
    <g class="node">
      <title>b</title>
      <ellipse fill="none" stroke="black" cx="178" cy="-18" rx="18" ry="18" />
      <text text-anchor="middle" x="178" y="-14.3" font-family="Times,serif" font-size="14.00">b</text>
    </g>
    <g class="edge">
      <title>h--b</title>
      <path fill="none" stroke="black" d="M115.19,-23.44C121.04,-21.68 127.75,-19.95 134,-19 142.42,-17.72 151.86,-17.38 159.76,-17.4" />
      <text text-anchor="middle" x="138" y="-22.8" font-family="Times,serif" font-size="14.00">3</text>
    </g>
    <g class="node">
      <title>d</title>
      <ellipse fill="none" stroke="black" cx="178" cy="-83" rx="18" ry="18" />
      <text text-anchor="middle" x="178" y="-79.3" font-family="Times,serif" font-size="14.00">d</text>
    </g>
    <g class="edge">
      <title>h--d</title>
      <path fill="none" stroke="black" d="M113.31,-38.9C127.38,-48.65 148.74,-63.44 162.78,-73.16" />
      <text text-anchor="middle" x="138" y="-60.8" font-family="Times,serif" font-size="14.00">1</text>
    </g>
    <g class="node">
      <title>c</title>
      <ellipse fill="none" stroke="black" cx="258" cy="-106" rx="18" ry="18" />
      <text text-anchor="middle" x="258" y="-102.3" font-family="Times,serif" font-size="14.00">c</text>
    </g>
    <g class="edge">
      <title>d--c</title>
      <path fill="none" stroke="black" d="M195.54,-87.88C208.78,-91.78 227.25,-97.23 240.48,-101.13" />
      <text text-anchor="middle" x="218" y="-98.8" font-family="Times,serif" font-size="14.00">2</text>
    </g>
    <g class="node">
      <title>g</title>
      <ellipse fill="none" stroke="black" cx="258" cy="-52" rx="18" ry="18" />
      <text text-anchor="middle" x="258" y="-48.3" font-family="Times,serif" font-size="14.00">g</text>
    </g>
    <g class="edge">
      <title>d--g</title>
      <path fill="none" stroke="black" d="M195.16,-76.58C208.64,-71.22 227.73,-63.63 241.13,-58.31" />
      <text text-anchor="middle" x="218" y="-71.8" font-family="Times,serif" font-size="14.00">3</text>
    </g>
    <g class="node">
      <title>e</title>
      <ellipse fill="none" stroke="black" cx="338" cy="-52" rx="18" ry="18" />
      <text text-anchor="middle" x="338" y="-48.3" font-family="Times,serif" font-size="14.00">e</text>
    </g>
    <g class="edge">
      <title>g--e</title>
      <path fill="none" stroke="black" d="M276.31,-52C289.24,-52 306.82,-52 319.74,-52" />
      <text text-anchor="middle" x="298" y="-55.8" font-family="Times,serif" font-size="14.00">4</text>
    </g>
    <g class="node">
      <title>f</title>
      <ellipse fill="none" stroke="black" cx="98" cy="-94" rx="18" ry="18" />
      <text text-anchor="middle" x="98" y="-90.3" font-family="Times,serif" font-size="14.00">f</text>
    </g>
    <g class="edge">
      <title>f--d</title>
      <path fill="none" stroke="black" d="M115.92,-91.61C129.01,-89.77 147.03,-87.23 160.11,-85.38" />
      <text text-anchor="middle" x="138" y="-91.8" font-family="Times,serif" font-size="14.00">4</text>
    </g>
    <g class="node">
      <title>a</title>
      <ellipse fill="none" stroke="black" cx="18" cy="-29" rx="18" ry="18" />
      <text text-anchor="middle" x="18" y="-25.3" font-family="Times,serif" font-size="14.00">a</text>
    </g>
    <g class="edge">
      <title>a--h</title>
      <path fill="none" stroke="black" d="M36.31,-29C49.24,-29 66.82,-29 79.74,-29" />
      <text text-anchor="middle" x="58" y="-32.8" font-family="Times,serif" font-size="14.00">2</text>
    </g>
  </g>
</svg>
<p><em>Figure 3: A weighted tree</em></p>

<p>We’ll get the following tree:</p>

<svg xmlns="http://www.w3.org/2000/svg" width="210pt" height="260pt" viewBox="0.00 0.00 210.19 260.00">
  <g class="graph" transform="scale(1 1) rotate(0) translate(4 256)">
    <title>%3</title>
    <g class="node">
      <title>df</title>
      <ellipse fill="none" stroke="black" cx="35.1" cy="-18" rx="35.19" ry="18" />
      <text text-anchor="middle" x="35.1" y="-14.3" font-family="Times,serif" font-size="14.00">df(4)</text>
    </g>
    <g class="node">
      <title>dg</title>
      <ellipse fill="none" stroke="black" cx="79.1" cy="-90" rx="35.19" ry="18" />
      <text text-anchor="middle" x="79.1" y="-86.3" font-family="Times,serif" font-size="14.00">dg(3)</text>
    </g>
    <g class="edge">
      <title>dg-&gt;df</title>
      <path fill="none" stroke="black" d="M68.89,-72.76C63.58,-64.32 56.97,-53.8 51.01,-44.31" />
      <polygon fill="black" stroke="black" points="53.84,-42.24 45.55,-35.63 47.91,-45.96 53.84,-42.24" />
    </g>
    <g class="node">
      <title>eg</title>
      <ellipse fill="none" stroke="black" cx="123.1" cy="-18" rx="35.19" ry="18" />
      <text text-anchor="middle" x="123.1" y="-14.3" font-family="Times,serif" font-size="14.00">eg(4)</text>
    </g>
    <g class="edge">
      <title>dg-&gt;eg</title>
      <path fill="none" stroke="black" d="M89.3,-72.76C94.61,-64.32 101.22,-53.8 107.19,-44.31" />
      <polygon fill="black" stroke="black" points="110.28,-45.96 112.64,-35.63 104.36,-42.24 110.28,-45.96" />
    </g>
    <g class="node">
      <title>cd</title>
      <ellipse fill="none" stroke="black" cx="79.1" cy="-162" rx="35.19" ry="18" />
      <text text-anchor="middle" x="79.1" y="-158.3" font-family="Times,serif" font-size="14.00">cd(2)</text>
    </g>
    <g class="edge">
      <title>cd-&gt;dg</title>
      <path fill="none" stroke="black" d="M79.1,-143.7C79.1,-135.98 79.1,-126.71 79.1,-118.11" />
      <polygon fill="black" stroke="black" points="82.6,-118.1 79.1,-108.1 75.6,-118.1 82.6,-118.1" />
    </g>
    <g class="node">
      <title>dh</title>
      <ellipse fill="none" stroke="black" cx="123.1" cy="-234" rx="35.19" ry="18" />
      <text text-anchor="middle" x="123.1" y="-230.3" font-family="Times,serif" font-size="14.00">dh(1)</text>
    </g>
    <g class="edge">
      <title>dh-&gt;cd</title>
      <path fill="none" stroke="black" d="M112.89,-216.76C107.58,-208.32 100.97,-197.8 95.01,-188.31" />
      <polygon fill="black" stroke="black" points="97.84,-186.24 89.55,-179.63 91.91,-189.96 97.84,-186.24" />
    </g>
    <g class="node">
      <title>ha</title>
      <ellipse fill="none" stroke="black" cx="167.1" cy="-162" rx="35.19" ry="18" />
      <text text-anchor="middle" x="167.1" y="-158.3" font-family="Times,serif" font-size="14.00">ha(2)</text>
    </g>
    <g class="edge">
      <title>dh-&gt;ha</title>
      <path fill="none" stroke="black" d="M133.3,-216.76C138.61,-208.32 145.22,-197.8 151.19,-188.31" />
      <polygon fill="black" stroke="black" points="154.28,-189.96 156.64,-179.63 148.36,-186.24 154.28,-189.96" />
    </g>
    <g class="node">
      <title>bh</title>
      <ellipse fill="none" stroke="black" cx="167.1" cy="-90" rx="35.19" ry="18" />
      <text text-anchor="middle" x="167.1" y="-86.3" font-family="Times,serif" font-size="14.00">bh(3)</text>
    </g>
    <g class="edge">
      <title>ha-&gt;bh</title>
      <path fill="none" stroke="black" d="M167.1,-143.7C167.1,-135.98 167.1,-126.71 167.1,-118.11" />
      <polygon fill="black" stroke="black" points="170.6,-118.1 167.1,-108.1 163.6,-118.1 170.6,-118.1" />
    </g>
  </g>
</svg>
<p><em>Figure 4: The result of transforming the previous tree</em></p>

<p>Do note that we lose the small tree height by doing this.</p>

<p>Due to the nature of edges, each node in our data structure is guaranteed to have at most 2 children, and so we will always get a binary tree out. With this transformation, we can convert “what is the minimum/<a href="https://en.wikipedia.org/wiki/Widest_path_problem">‘bottleneck’ edge</a> on the path from edge E to edge F” queries into <a href="https://en.wikipedia.org/wiki/Lowest_common_ancestor">Lowest Common Ancestor</a>, similar to the Cartesian tree.</p>

<p>However, typical <a href="https://en.wikipedia.org/wiki/Widest_path_problem">bottleneck edge</a> queries are based on the path between <em>vertices</em>, which we can support using a nice trick: adding individual vertices as <em>leaves</em> in our data structure<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote">1</a></sup> – another way of looking at it is that we add self-loops to every vertex in the input before transforming it. This final step gives us the Kruskal Tree.</p>

<p>Furthermore, we can also answer “how many vertices can be reached from V without traversing edges with weight under W?” by finding the highest ancestor of V with a weight of at least W, then counting the number of nodes in its subtree.</p>

<p>For general graphs, we can observe (using Kruskal’s Algorithm) that the bottleneck edge is always on the MST to reduce it to a tree problem. This data structure is also commonly made by augmenting Kruskal’s Algorithm to track the roots of components and to create edge nodes when merging them – hence the name.</p>

<h2 id="flattening-the-kruskal-tree"><a href="#flattening-the-kruskal-tree">Flattening the Kruskal Tree</a></h2>

<p>An interesting side-effect of making the tree binary is that an <a href="https://en.wikipedia.org/wiki/Tree_traversal#In-order_(LNR)">in-order traversal</a> is well-defined, and that <a href="https://en.wikipedia.org/wiki/Lowest_common_ancestor">LCA</a> can be converted into “what is the largest element in this subarray” (<a href="https://en.wikipedia.org/wiki/Range_minimum_query">Range Min Query, or RMQ</a>):</p>

<svg xmlns="http://www.w3.org/2000/svg" width="1088pt" height="553pt" viewBox="0.00 0.00 1088.00 552.91">
  <g class="graph" transform="scale(1 1) rotate(0) translate(4 548.91)">
    <title>%3</title>
    <g class="node">
      <title>ar</title>
      <polygon fill="none" stroke="black" points="0,-470.41 0,-544.41 1080,-544.41 1080,-470.41 0,-470.41" />
      <text text-anchor="middle" x="34" y="-499.91" font-family="Times,serif" font-size="30.00">c</text>
      <polyline fill="none" stroke="black" points="68,-470.41 68,-544.41" />
      <text text-anchor="middle" x="106" y="-516.41" font-family="Times,serif" font-size="30.00">cd</text>
      <text text-anchor="middle" x="106" y="-483.41" font-family="Times,serif" font-size="30.00">2</text>
      <polyline fill="none" stroke="black" points="144,-470.41 144,-544.41" />
      <text text-anchor="middle" x="178" y="-499.91" font-family="Times,serif" font-size="30.00">d</text>
      <polyline fill="none" stroke="black" points="212,-470.41 212,-544.41" />
      <text text-anchor="middle" x="250.5" y="-516.41" font-family="Times,serif" font-size="30.00">df</text>
      <text text-anchor="middle" x="250.5" y="-483.41" font-family="Times,serif" font-size="30.00">4</text>
      <polyline fill="none" stroke="black" points="289,-470.41 289,-544.41" />
      <text text-anchor="middle" x="323" y="-499.91" font-family="Times,serif" font-size="30.00">f</text>
      <polyline fill="none" stroke="black" points="357,-470.41 357,-544.41" />
      <text text-anchor="middle" x="395" y="-516.41" font-family="Times,serif" font-size="30.00">dg</text>
      <text text-anchor="middle" x="395" y="-483.41" font-family="Times,serif" font-size="30.00">3</text>
      <polyline fill="none" stroke="black" points="433,-470.41 433,-544.41" />
      <text text-anchor="middle" x="467" y="-499.91" font-family="Times,serif" font-size="30.00">e</text>
      <polyline fill="none" stroke="black" points="501,-470.41 501,-544.41" />
      <text text-anchor="middle" x="539.5" y="-516.41" font-family="Times,serif" font-size="30.00">eg</text>
      <text text-anchor="middle" x="539.5" y="-483.41" font-family="Times,serif" font-size="30.00">4</text>
      <polyline fill="none" stroke="black" points="578,-470.41 578,-544.41" />
      <text text-anchor="middle" x="612" y="-499.91" font-family="Times,serif" font-size="30.00">g</text>
      <polyline fill="none" stroke="black" points="646,-470.41 646,-544.41" />
      <text text-anchor="middle" x="684" y="-516.41" font-family="Times,serif" font-size="30.00">dh</text>
      <text text-anchor="middle" x="684" y="-483.41" font-family="Times,serif" font-size="30.00">1</text>
      <polyline fill="none" stroke="black" points="722,-470.41 722,-544.41" />
      <text text-anchor="middle" x="756" y="-499.91" font-family="Times,serif" font-size="30.00">a</text>
      <polyline fill="none" stroke="black" points="790,-470.41 790,-544.41" />
      <text text-anchor="middle" x="828.5" y="-516.41" font-family="Times,serif" font-size="30.00">ha</text>
      <text text-anchor="middle" x="828.5" y="-483.41" font-family="Times,serif" font-size="30.00">2</text>
      <polyline fill="none" stroke="black" points="867,-470.41 867,-544.41" />
      <text text-anchor="middle" x="901" y="-499.91" font-family="Times,serif" font-size="30.00">b</text>
      <polyline fill="none" stroke="black" points="935,-470.41 935,-544.41" />
      <text text-anchor="middle" x="973" y="-516.41" font-family="Times,serif" font-size="30.00">bh</text>
      <text text-anchor="middle" x="973" y="-483.41" font-family="Times,serif" font-size="30.00">3</text>
      <polyline fill="none" stroke="black" points="1011,-470.41 1011,-544.41" />
      <text text-anchor="middle" x="1045.5" y="-499.91" font-family="Times,serif" font-size="30.00">h</text>
    </g>
    <g class="node">
      <title>cd</title>
      <ellipse fill="none" stroke="black" cx="106" cy="-122.97" rx="28.98" ry="28.98" />
      <text text-anchor="middle" x="106" y="-115.47" font-family="Times,serif" font-size="30.00">cd</text>
    </g>
    <g class="edge">
      <title>ar:cd-&gt;cd</title>
      <path fill="none" stroke="grey" stroke-dasharray="5,2" d="M106,-469.91C106,-351.9 106,-211.24 106,-152.22" />
    </g>
    <g class="node">
      <title>dh</title>
      <ellipse fill="none" stroke="black" cx="684" cy="-28.99" rx="28.98" ry="28.98" />
      <text text-anchor="middle" x="684" y="-21.49" font-family="Times,serif" font-size="30.00">dh</text>
    </g>
    <g class="edge">
      <title>ar:dh-&gt;dh</title>
      <path fill="none" stroke="grey" stroke-dasharray="5,2" d="M684,-469.91C684,-399.7 684,-382.15 684,-311.94 684,-311.94 684,-311.94 684,-215.96 684,-159.94 684,-94.43 684,-58.03" />
    </g>
    <g class="node">
      <title>ha</title>
      <ellipse fill="none" stroke="black" cx="829" cy="-216.96" rx="28.98" ry="28.98" />
      <text text-anchor="middle" x="829" y="-209.46" font-family="Times,serif" font-size="30.00">ha</text>
    </g>
    <g class="edge">
      <title>ar:ha-&gt;ha</title>
      <path fill="none" stroke="grey" stroke-dasharray="5,2" d="M829,-469.91C829,-388.77 829,-292.93 829,-246.3" />
    </g>
    <g class="node">
      <title>dg</title>
      <ellipse fill="none" stroke="black" cx="395" cy="-216.96" rx="28.98" ry="28.98" />
      <text text-anchor="middle" x="395" y="-209.46" font-family="Times,serif" font-size="30.00">dg</text>
    </g>
    <g class="edge">
      <title>ar:dg-&gt;dg</title>
      <path fill="none" stroke="grey" stroke-dasharray="5,2" d="M395,-469.91C395,-388.77 395,-292.93 395,-246.3" />
    </g>
    <g class="node">
      <title>bh</title>
      <ellipse fill="none" stroke="black" cx="973" cy="-310.94" rx="28.98" ry="28.98" />
      <text text-anchor="middle" x="973" y="-303.44" font-family="Times,serif" font-size="30.00">bh</text>
    </g>
    <g class="edge">
      <title>ar:bh-&gt;bh</title>
      <path fill="none" stroke="grey" stroke-dasharray="5,2" d="M973,-469.91C973,-424.52 973,-371.8 973,-340.19" />
    </g>
    <g class="node">
      <title>df</title>
      <ellipse fill="none" stroke="black" cx="250" cy="-310.94" rx="28.98" ry="28.98" />
      <text text-anchor="middle" x="250" y="-303.44" font-family="Times,serif" font-size="30.00">df</text>
    </g>
    <g class="edge">
      <title>ar:df-&gt;df</title>
      <path fill="none" stroke="grey" stroke-dasharray="5,2" d="M250,-469.91C250,-424.52 250,-371.8 250,-340.19" />
    </g>
    <g class="node">
      <title>eg</title>
      <ellipse fill="none" stroke="black" cx="539" cy="-310.94" rx="28.98" ry="28.98" />
      <text text-anchor="middle" x="539" y="-303.44" font-family="Times,serif" font-size="30.00">eg</text>
    </g>
    <g class="edge">
      <title>ar:eg-&gt;eg</title>
      <path fill="none" stroke="grey" stroke-dasharray="5,2" d="M539,-469.91C539,-424.52 539,-371.8 539,-340.19" />
    </g>
    <g class="node">
      <title>c</title>
      <ellipse fill="none" stroke="black" cx="34" cy="-404.92" rx="28.98" ry="28.98" />
      <text text-anchor="middle" x="34" y="-397.42" font-family="Times,serif" font-size="30.00">c</text>
    </g>
    <g class="edge">
      <title>ar:c-&gt;c</title>
      <path fill="none" stroke="grey" stroke-dasharray="5,2" d="M34,-469.91C34,-458.14 34,-445.14 34,-433.96" />
    </g>
    <g class="node">
      <title>d</title>
      <ellipse fill="none" stroke="black" cx="178" cy="-404.92" rx="28.98" ry="28.98" />
      <text text-anchor="middle" x="178" y="-397.42" font-family="Times,serif" font-size="30.00">d</text>
    </g>
    <g class="edge">
      <title>ar:d-&gt;d</title>
      <path fill="none" stroke="grey" stroke-dasharray="5,2" d="M178,-469.91C178,-458.14 178,-445.14 178,-433.96" />
    </g>
    <g class="node">
      <title>f</title>
      <ellipse fill="none" stroke="black" cx="323" cy="-404.92" rx="28.98" ry="28.98" />
      <text text-anchor="middle" x="323" y="-397.42" font-family="Times,serif" font-size="30.00">f</text>
    </g>
    <g class="edge">
      <title>ar:f-&gt;f</title>
      <path fill="none" stroke="grey" stroke-dasharray="5,2" d="M323,-469.91C323,-458.14 323,-445.14 323,-433.96" />
    </g>
    <g class="node">
      <title>e</title>
      <ellipse fill="none" stroke="black" cx="467" cy="-404.92" rx="28.98" ry="28.98" />
      <text text-anchor="middle" x="467" y="-397.42" font-family="Times,serif" font-size="30.00">e</text>
    </g>
    <g class="edge">
      <title>ar:e-&gt;e</title>
      <path fill="none" stroke="grey" stroke-dasharray="5,2" d="M467,-469.91C467,-458.14 467,-445.14 467,-433.96" />
    </g>
    <g class="node">
      <title>g</title>
      <ellipse fill="none" stroke="black" cx="612" cy="-404.92" rx="28.98" ry="28.98" />
      <text text-anchor="middle" x="612" y="-397.42" font-family="Times,serif" font-size="30.00">g</text>
    </g>
    <g class="edge">
      <title>ar:g-&gt;g</title>
      <path fill="none" stroke="grey" stroke-dasharray="5,2" d="M612,-469.91C612,-458.14 612,-445.14 612,-433.96" />
    </g>
    <g class="node">
      <title>a</title>
      <ellipse fill="none" stroke="black" cx="756" cy="-404.92" rx="28.98" ry="28.98" />
      <text text-anchor="middle" x="756" y="-397.42" font-family="Times,serif" font-size="30.00">a</text>
    </g>
    <g class="edge">
      <title>ar:a-&gt;a</title>
      <path fill="none" stroke="grey" stroke-dasharray="5,2" d="M756,-469.91C756,-458.14 756,-445.14 756,-433.96" />
    </g>
    <g class="node">
      <title>b</title>
      <ellipse fill="none" stroke="black" cx="901" cy="-404.92" rx="28.98" ry="28.98" />
      <text text-anchor="middle" x="901" y="-397.42" font-family="Times,serif" font-size="30.00">b</text>
    </g>
    <g class="edge">
      <title>ar:b-&gt;b</title>
      <path fill="none" stroke="grey" stroke-dasharray="5,2" d="M901,-469.91C901,-458.14 901,-445.14 901,-433.96" />
    </g>
    <g class="node">
      <title>h</title>
      <ellipse fill="none" stroke="black" cx="1046" cy="-404.92" rx="28.98" ry="28.98" />
      <text text-anchor="middle" x="1046" y="-397.42" font-family="Times,serif" font-size="30.00">h</text>
    </g>
    <g class="edge">
      <title>ar:h-&gt;h</title>
      <path fill="none" stroke="grey" stroke-dasharray="5,2" d="M1046,-469.91C1046,-458.14 1046,-445.14 1046,-433.96" />
    </g>
    <g class="edge">
      <title>cd-&gt;dh</title>
      <path fill="none" stroke="black" d="M134.66,-117.41C230.01,-102.24 536.59,-53.45 645.32,-36.15" />
      <polygon fill="black" stroke="black" points="646.18,-39.55 655.51,-34.53 645.08,-32.64 646.18,-39.55" />
    </g>
    <g class="edge">
      <title>ha-&gt;dh</title>
      <path fill="none" stroke="black" d="M811.51,-193.53C785.6,-160.29 736.95,-97.9 707.81,-60.53" />
      <polygon fill="black" stroke="black" points="710.46,-58.24 701.55,-52.5 704.94,-62.54 710.46,-58.24" />
    </g>
    <g class="edge">
      <title>dg-&gt;cd</title>
      <path fill="none" stroke="black" d="M367.55,-207.22C315.47,-190.65 202.28,-154.62 143.35,-135.86" />
      <polygon fill="black" stroke="black" points="144.28,-132.48 133.69,-132.79 142.16,-139.15 144.28,-132.48" />
    </g>
    <g class="edge">
      <title>bh-&gt;ha</title>
      <path fill="none" stroke="black" d="M948.9,-294.54C925.02,-279.29 888.27,-255.81 861.75,-238.88" />
      <polygon fill="black" stroke="black" points="863.49,-235.84 853.18,-233.4 859.72,-241.74 863.49,-235.84" />
    </g>
    <g class="edge">
      <title>df-&gt;dg</title>
      <path fill="none" stroke="black" d="M274.27,-294.54C298.32,-279.29 335.32,-255.81 362.02,-238.88" />
      <polygon fill="black" stroke="black" points="364.08,-241.72 370.65,-233.4 360.33,-235.8 364.08,-241.72" />
    </g>
    <g class="edge">
      <title>eg-&gt;dg</title>
      <path fill="none" stroke="black" d="M514.9,-294.54C491.02,-279.29 454.27,-255.81 427.75,-238.88" />
      <polygon fill="black" stroke="black" points="429.49,-235.84 419.18,-233.4 425.72,-241.74 429.49,-235.84" />
    </g>
    <g class="edge">
      <title>c-&gt;cd</title>
      <path fill="none" stroke="black" d="M41.03,-376.57C54.02,-326.08 81.76,-218.21 96.44,-161.14" />
      <polygon fill="black" stroke="black" points="99.84,-161.99 98.94,-151.44 93.06,-160.25 99.84,-161.99" />
    </g>
    <g class="edge">
      <title>d-&gt;df</title>
      <path fill="none" stroke="black" d="M195.43,-381.66C204.65,-369.88 216.1,-355.25 226.13,-342.43" />
      <polygon fill="black" stroke="black" points="229.07,-344.35 232.48,-334.32 223.56,-340.04 229.07,-344.35" />
    </g>
    <g class="edge">
      <title>f-&gt;df</title>
      <path fill="none" stroke="black" d="M305.33,-381.66C295.98,-369.88 284.37,-355.25 274.2,-342.43" />
      <polygon fill="black" stroke="black" points="276.72,-339.98 267.76,-334.32 271.24,-344.33 276.72,-339.98" />
    </g>
    <g class="edge">
      <title>e-&gt;eg</title>
      <path fill="none" stroke="black" d="M484.43,-381.66C493.65,-369.88 505.1,-355.25 515.13,-342.43" />
      <polygon fill="black" stroke="black" points="518.07,-344.35 521.48,-334.32 512.56,-340.04 518.07,-344.35" />
    </g>
    <g class="edge">
      <title>g-&gt;eg</title>
      <path fill="none" stroke="black" d="M594.33,-381.66C584.98,-369.88 573.37,-355.25 563.2,-342.43" />
      <polygon fill="black" stroke="black" points="565.72,-339.98 556.76,-334.32 560.24,-344.33 565.72,-339.98" />
    </g>
    <g class="edge">
      <title>a-&gt;ha</title>
      <path fill="none" stroke="black" d="M766.3,-377.67C778.99,-345.37 800.58,-290.35 814.82,-254.07" />
      <polygon fill="black" stroke="black" points="818.23,-254.96 818.63,-244.37 811.72,-252.4 818.23,-254.96" />
    </g>
    <g class="edge">
      <title>b-&gt;bh</title>
      <path fill="none" stroke="black" d="M918.43,-381.66C927.65,-369.88 939.1,-355.25 949.13,-342.43" />
      <polygon fill="black" stroke="black" points="952.07,-344.35 955.48,-334.32 946.56,-340.04 952.07,-344.35" />
    </g>
    <g class="edge">
      <title>h-&gt;bh</title>
      <path fill="none" stroke="black" d="M1028.33,-381.66C1018.98,-369.88 1007.37,-355.25 997.2,-342.43" />
      <polygon fill="black" stroke="black" points="999.72,-339.98 990.76,-334.32 994.24,-344.33 999.72,-339.98" />
    </g>
  </g>
</svg>
<p><em>Figure 5: In-order traversal of the previous tree</em></p>

<p>This allows us to use a segment tree, which is much easier to implement than binary lifting/jump pointers. Plus, that diagram looks really nice.</p>

<h2 id="near-and-far-children"><a href="#near-and-far-children">Near and Far Children</a></h2>

<blockquote>
  <p>Originally called near-far ordering. I believe this is also different to the “macro-micro decomposition” referred to in the paper.</p>
</blockquote>

<p>An extension of the Kruskal Tree is to also track for each node which child is “between” it and its parent, in the sense that a path from it to the parent goes through edges in that subtree. For example, <code class="language-plaintext highlighter-rouge">bh</code> would “between” <code class="language-plaintext highlighter-rouge">ha</code> and <code class="language-plaintext highlighter-rouge">dh</code>. Our construction guarantees that for every edge except the root, exactly one child is “between” – we’ll call this the <em>near</em> child, and the other the <em>far</em> child.</p>

<p>The surprising benefit of this extra information is that you can now perform edge deletions in <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span>! To remove an edge, we attach the near child to the parent and separate the far child:</p>

<svg xmlns="http://www.w3.org/2000/svg" width="348pt" height="220pt" viewBox="0.00 0.00 348.00 220.00">
  <g class="graph" transform="scale(1 1) rotate(0) translate(4 216)">
    <title>%3</title>
    <g class="cluster">
      <title>cluster_0</title>
      <polygon fill="transparent" stroke="black" points="8,-8 8,-204 158,-204 158,-8 8,-8" />
    </g>
    <g class="cluster">
      <title>cluster_1</title>
      <polygon fill="transparent" stroke="black" points="166,-80 166,-204 332,-204 332,-80 166,-80" />
    </g>
    <g class="node">
      <title>parent</title>
      <ellipse fill="none" stroke="black" cx="83" cy="-178" rx="40.09" ry="18" />
      <text text-anchor="middle" x="83" y="-174.3" font-family="Times,serif" font-size="14.00">parent</text>
    </g>
    <g class="node">
      <title>elem</title>
      <ellipse fill="none" stroke="black" cx="83" cy="-106" rx="30.59" ry="18" />
      <text text-anchor="middle" x="83" y="-102.3" font-family="Times,serif" font-size="14.00">elem</text>
    </g>
    <g class="edge">
      <title>parent-&gt;elem</title>
      <path fill="none" stroke="black" d="M83,-159.7C83,-151.98 83,-142.71 83,-134.11" />
      <polygon fill="black" stroke="black" points="86.5,-134.1 83,-124.1 79.5,-134.1 86.5,-134.1" />
    </g>
    <g class="node">
      <title>near</title>
      <ellipse fill="none" stroke="black" cx="47" cy="-34" rx="30.59" ry="18" />
      <text text-anchor="middle" x="47" y="-30.3" font-family="Times,serif" font-size="14.00">near</text>
    </g>
    <g class="edge">
      <title>elem-&gt;near</title>
      <path fill="none" stroke="black" d="M74.47,-88.41C70.16,-80.04 64.85,-69.71 60.05,-60.37" />
      <polygon fill="black" stroke="black" points="63.16,-58.76 55.47,-51.47 56.93,-61.96 63.16,-58.76" />
    </g>
    <g class="node">
      <title>far</title>
      <ellipse fill="none" stroke="black" cx="123" cy="-34" rx="27" ry="18" />
      <text text-anchor="middle" x="123" y="-30.3" font-family="Times,serif" font-size="14.00">far</text>
    </g>
    <g class="edge">
      <title>elem-&gt;far</title>
      <path fill="none" stroke="black" d="M92.28,-88.76C97.17,-80.19 103.29,-69.49 108.77,-59.9" />
      <polygon fill="black" stroke="black" points="111.85,-61.57 113.77,-51.15 105.77,-58.09 111.85,-61.57" />
    </g>
    <g class="node">
      <title>parent'</title>
      <ellipse fill="none" stroke="black" cx="249" cy="-178" rx="44.69" ry="18" />
      <text text-anchor="middle" x="249" y="-174.3" font-family="Times,serif" font-size="14.00">parent'</text>
    </g>
    <g class="node">
      <title>near'</title>
      <ellipse fill="none" stroke="black" cx="209" cy="-106" rx="35.19" ry="18" />
      <text text-anchor="middle" x="209" y="-102.3" font-family="Times,serif" font-size="14.00">near'</text>
    </g>
    <g class="edge">
      <title>parent'-&gt;near'</title>
      <path fill="none" stroke="black" d="M239.32,-160.05C234.6,-151.8 228.83,-141.7 223.59,-132.54" />
      <polygon fill="black" stroke="black" points="226.59,-130.73 218.59,-123.79 220.52,-134.21 226.59,-130.73" />
    </g>
    <g class="node">
      <title>far'</title>
      <ellipse fill="none" stroke="black" cx="293" cy="-106" rx="30.59" ry="18" />
      <text text-anchor="middle" x="293" y="-102.3" font-family="Times,serif" font-size="14.00">far'</text>
    </g>
    <g class="edge">
      <title>parent'-&gt;far'</title>
      <path fill="none" stroke="transparent" d="M259.43,-160.41C264.74,-151.95 271.32,-141.49 277.24,-132.08" />
      <polygon fill="transparent" stroke="transparent" points="280.29,-133.8 282.65,-123.47 274.36,-130.07 280.29,-133.8" />
    </g>
  </g>
</svg>
<p><em>Figure 6: Removing an edge</em></p>

<p>If we also support the ability to get the root node of any tree to check if two vertices are connected, we’ll be able to support what’s known as <em>decremental connectivity</em> on a tree.</p>

<p>Implementation-wise, we can use a treap (<a href="https://en.wikipedia.org/wiki/Join-based_tree_algorithms">or any data structure resembling a <em>rope</em></a>) to store the flattened version of the tree. Creating this structure in the first place is “left as an exercise to the reader.”<sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote">2</a></sup></p>

<h2 id="further-reading"><a href="#further-reading">Further Reading</a></h2>

<p>While looking at existing literature, I found some interesting papers discussing data structures similar to what I’ve described here:</p>

<ul>
  <li><a href="https://erikdemaine.org/papers/Cartesian_ICALP2009/paper.pdf">“On Cartesian Trees and Range Minimum Queries”</a></li>
  <li><a href="https://www.cs.princeton.edu/research/techreps/TR-096-87">“Computing on a Free Tree Via Complexity-Preserving Mappings”</a></li>
</ul>

<hr />

<h2 id="extra-trees-arising-from-divide-and-conquer"><a href="#extra-trees-arising-from-divide-and-conquer">Extra: Trees Arising From Divide and Conquer</a></h2>

<p>A general idea we can take from centroid trees is that many recursive procedures can lend themselves to trees. In the original version of this article, I called them “implicit divide and conquer trees”<sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote">3</a></sup>, and are roughly made by:</p>

<ol>
  <li>picking an element from a structure and extracting it into the root of a tree; then</li>
  <li>recursing into the remaining parts and adding the returned trees as children.</li>
</ol>

<p>However, they can be generalised even further: instead of directly <em>extracting an element</em> a root node, we can let it be whatever information of about the structure we want. This definition covers a wide range of tree data structures, including:</p>

<ul>
  <li>Binary search trees, and their self-balancing variants</li>
  <li>Segment trees (with square-root decomposition as a kind of variant)</li>
  <li>Interval trees</li>
  <li>Tries</li>
</ul>

<p>So, in one way they’re way too general of a category, but it can still be a useful idea to consider.</p>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>Normally this problem is solved either using a modified Dijskstra’s/Prim’s algorithm, or even Kruskal’s MST algorithm if all queries are available in advance. <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p>I haven’t really thought about how to construct this, even a year after the original article. <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:3" role="doc-endnote">
      <p>Thanks you Tunan for suggesting this name. <a href="#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

</article>

<nav class="post-nav flex-distribute my-1">
	
		<a class="prev" href="/posts/speed-of-light">&laquo; A simple "derivation" of the speed of light</a>
	

	
		<a class="next" href="/posts/nearer-optimal-solution">Proving Algorithms using Nearer Optimal Solution &raquo;</a>
	
</nav>


		</main>

		<div id="site-footer" class="content-width text-centre">
		<ul class="li-flat mt-0">
			<li><a href="/everything">everything</a></li>
			<li><a href="/booklist">reading list</a></li>
		</ul>
		All work licensed under <b>CC BY-SA 4.0</b> unless otherwise stated.
		<br>
		This site is <a href="https://github.com/ralismark/ralismark.github.io">open source</a>!
</div>

	</body>
</html>
